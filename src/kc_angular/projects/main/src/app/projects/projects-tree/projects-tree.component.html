<div class="projects-tree-controls-container">
  <button [matTooltipClass]="{'tool-tip':true}"
          matTooltip="Create a new project"
          matTooltipShowDelay="750"
          (click)="newProject()"
          mat-icon-button>
    <mat-icon>add</mat-icon>
  </button>
  <button [matTooltipClass]="{'tool-tip':true}"
          matTooltip="Expand all projects"
          matTooltipShowDelay="750"
          (click)="expandTree()"
          mat-icon-button>
    <mat-icon>unfold_more</mat-icon>
  </button>
  <button [matTooltipClass]="{'tool-tip':true}"
          matTooltip="Collapse all projects"
          matTooltipShowDelay="750"
          (click)="collapseTree()"
          mat-icon-button>
    <mat-icon>unfold_less</mat-icon>
  </button>
<!--  TODO: eventually add these back in...-->
<!--  <button [matTooltipClass]="{'tool-tip':true}"-->
<!--          matTooltip="Focus on current project"-->
<!--          matTooltipShowDelay="750"-->
<!--          (click)="focus()"-->
<!--          mat-icon-button>-->
<!--    <mat-icon>filter_center_focus</mat-icon>-->
<!--  </button>-->
<!--  <button [matTooltipClass]="{'tool-tip':true}"-->
<!--          matTooltip="Filter projects"-->
<!--          matTooltipShowDelay="750"-->
<!--          (click)="filter()"-->
<!--          mat-icon-button>-->
<!--    <mat-icon>filter_list</mat-icon>-->
<!--  </button>-->
</div>

<mat-tree [dataSource]="dataSource" [treeControl]="treeControl">
  <mat-tree-node [ngClass]="{ 'background-highlight': activeId === node.id }"
                 (contextmenu)="onContextMenu($event, node.id)"
                 *matTreeNodeDef="let node; when: hasChild"
                 [matTreeNodePaddingIndent]="treePadding"
                 (click)="selectProject(node.id)"
                 matTreeNodePadding>

    <button [attr.aria-label]="'Toggle ' + node.name"
            (click)="toggleNode(node)"
            matTreeNodeToggle
            mat-icon-button
            disableRipple>

      <mat-icon class="mat-icon-rtl-mirror">
        {{treeControl.isExpanded(node) ? 'expand_more' : 'chevron_right'}}
      </mat-icon>
    </button>

    <span class="kc-font-changeable">{{node.name}}</span>

    <span class="fill-space"></span>

    <div style="visibility: hidden; position: fixed"
         [style.left]="contextMenuPosition.x"
         [style.top]="contextMenuPosition.y"
         [matMenuTriggerFor]="contextMenu1">
    </div>

    <mat-menu #contextMenu1 class="kc-font-changeable">
      <button (click)="newProject()" mat-menu-item>
        <mat-icon>playlist_add</mat-icon>
        Add Subproject
      </button>
      <mat-divider></mat-divider>
      <button (click)="moveProject()" mat-menu-item>
        <mat-icon>low_priority</mat-icon>
        Move
      </button>
      <mat-divider></mat-divider>
      <button (click)="delete()" mat-menu-item>
        <mat-icon color="warn">delete</mat-icon>
        Delete
      </button>
    </mat-menu>

  </mat-tree-node>


  <mat-tree-node [ngClass]="{ 'background-highlight': activeId === node.id }"
                 (contextmenu)="onContextMenu($event, node.id)"
                 [matTreeNodePaddingIndent]="treePadding"
                 (click)="selectProject(node.id)"
                 *matTreeNodeDef="let node"
                 matTreeNodePadding
                 matTreeNodeToggle>

    <div style="visibility: hidden; position: fixed"
         [style.left]="contextMenuPosition.x"
         [style.top]="contextMenuPosition.y"
         [matMenuTriggerFor]="contextMenu2">
    </div>

    <span>
      <button (contextmenu)="onContextMenu($event, node.id)"
              (click)="selectProject(node.id)"
              class="kc-context-menu-trigger"
              mat-icon-button
              disableRipple>
      </button>
    </span>

    <span class="kc-font-changeable">{{node.name}}</span>

    <mat-menu #contextMenu2>
      <button (click)="newProject()" mat-menu-item>
        <mat-icon>playlist_add</mat-icon>
        Add Subproject
      </button>
      <mat-divider></mat-divider>
      <button (click)="moveProject()" mat-menu-item>
        <mat-icon>low_priority</mat-icon>
        Move
      </button>
      <mat-divider></mat-divider>
      <button (click)="delete()" mat-menu-item>
        <mat-icon color="warn">delete</mat-icon>
        Delete
      </button>
    </mat-menu>

  </mat-tree-node>
</mat-tree>


