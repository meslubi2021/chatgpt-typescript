<!--Copyright 2021 Rob Royce-->

<!--Licensed under the Apache License, Version 2.0 (the "License");-->
<!--you may not use this file except in compliance with the License.-->
<!--You may obtain a copy of the License at-->

<!--http://www.apache.org/licenses/LICENSE-2.0-->

<!--Unless required by applicable law or agreed to in writing, software-->
<!--distributed under the License is distributed on an "AS IS" BASIS,-->
<!--WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.-->
<!--See the License for the specific language governing permissions and-->
<!--limitations under the License.-->

<app-settings-common-header header="Ingest"></app-settings-common-header>

<div class="container">
  <div class="row">
    <div class="col">
      <h2>Autoscan</h2>
    </div>
    <div class="col">
      <mat-icon [matTooltip]="autoscanHelp"
                matTooltipClass="tool-tip">info
      </mat-icon>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <mat-hint style="color: red">Autoscan functionality is considered <b>experimental</b> and may cause data loss, use at your own risk</mat-hint>
    </div>
  </div>
  <div class="row">
    <div class="col s4">
      <mat-slide-toggle [(ngModel)]="ingestSettings.autoscan" (change)="autoscanClicked($event)">
        Autoscan
      </mat-slide-toggle>
    </div>
    <div class="col s4" *ngIf="ingestSettings.autoscan">
      <mat-slide-toggle [(ngModel)]="ingestSettings.managed"
                        [disabled]="ingestSettings.autoscan === true"
                        (change)="managedClicked($event)">
        Manage My Files
      </mat-slide-toggle>
    </div>
    <div class="col s4" *ngIf="ingestSettings.autoscan">
      <mat-slide-toggle [(ngModel)]="ingestSettings.preserveTimestamps"
                        (change)="preserveClicked($event)">Preserve Timestamps
      </mat-slide-toggle>
    </div>
  </div>

  <div class="row" *ngIf="ingestSettings.autoscan">
    <div class="col s3">
      <mat-form-field (change)="onIntervalChange($event)">
        <mat-label>Scan for changes every:</mat-label>
        <input matInput type="number" placeholder="Ex. 15" [(ngModel)]="interval" min="10" max="120">
        <span matSuffix>seconds</span>
      </mat-form-field>
    </div>
    <div class="col s1" *ngIf="intervalChanged">
      <button mat-button (click)="applyIntervalChange()" color="primary" class="jello-vertical">Apply</button>
    </div>
  </div>

  <div class="kc-danger-zone" *ngIf="ingestSettings.autoscan">
<!--    <h2 style="color:red">Danger Zone</h2>-->
    <div>
      <b>Extremely important:</b> All files in the chosen directory will be moved to a new directory and their names
      will be changed. <b>DO NOT</b> change this to a directory that contains files you care about or if you need direct
      access to the files in it. We recommend you create a new folder or use the default folder instead. The default
      folder has already been created for you inside your Downloads folder.
    </div>
    <br>

    <div class="row">
      <div class="col s12">
        <mat-form-field (change)="autoscanLocationClicked($event)">
          <mat-label>Autoscan Location</mat-label>
          <input matInput [(ngModel)]="ingestSettings.autoscanLocation" required>
          <button matSuffix mat-icon-button (click)="folderSelect()">
            <mat-icon>folder_open</mat-icon>
          </button>
        </mat-form-field>
      </div>
    </div>
  </div>
</div>
